import{r,j as e,e as $,L as A,d as b,S as F}from"./index-DA1mDptU.js";import{M as H,D as I,W as j,C as c,L as O,a as T,b as q,c as G,d as J,P as K,e as Q,p as U,f as V,g as X,i as Y}from"./index-BjvgM52f.js";import{A as Z}from"./arrow-left-CWL5Ak5O.js";import{S as ee}from"./search-CEkv8oE8.js";import{l as N}from"./proxy-kx--bhzL.js";q.register(G,J,K,Q,U,V,X,Y);const ie=()=>{const[o,y]=r.useState("Changsha"),[s,v]=r.useState(null),[a,C]=r.useState(null),[d,m]=r.useState(!1),[h,x]=r.useState(""),u=async t=>{try{m(!0),x("");const l=await b.get(`https://geocoding-api.open-meteo.com/v1/search?name=${t}&count=1&language=en&format=json`);if(!l.data.results||l.data.results.length===0)throw new Error("未找到该城市");const{latitude:E,longitude:W,name:R,country:P}=l.data.results[0],p=await b.get(`https://api.open-meteo.com/v1/forecast?latitude=${E}&longitude=${W}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&hourly=temperature_2m&timezone=auto`),i=p.data.current,w=p.data.hourly;v({temp:Math.round(i.temperature_2m),condition:k(i.weather_code),humidity:i.relative_humidity_2m,wind:i.wind_speed_10m,name:R,country:P});const z=w.time.slice(0,24),B=w.temperature_2m.slice(0,24),f=[],g=[];for(let n=0;n<24;n+=3){const M=new Date(z[n]);f.push(M.getHours()+":00"),g.push(B[n])}C({labels:f,data:g})}catch(l){console.error(l),x("未找到该城市或网络错误")}finally{m(!1)}};r.useEffect(()=>{u("Changsha")},[]);const _=t=>{t.preventDefault(),o.trim()&&u(o)},k=t=>t===0?"晴朗":t>=1&&t<=3?"多云":t>=51&&t<=67||t>=80&&t<=82?"雨":t>=71&&t<=77?"雪":t>=95?"暴风雨":"多云",S=t=>{switch(t){case"晴朗":return e.jsx(F,{className:"w-24 h-24 text-yellow-400 animate-spin-slow"});case"雨":return e.jsx(T,{className:"w-24 h-24 text-blue-400 animate-bounce"});case"暴风雨":return e.jsx(j,{className:"w-24 h-24 text-purple-500 animate-pulse"});case"雪":return e.jsx(c,{className:"w-24 h-24 text-white"});default:return e.jsx(c,{className:"w-24 h-24 text-gray-200"})}},L={labels:(a==null?void 0:a.labels)||[],datasets:[{label:"温度 (°C)",data:(a==null?void 0:a.data)||[],borderColor:"rgba(255, 255, 255, 0.8)",backgroundColor:"rgba(255, 255, 255, 0.2)",fill:!0,tension:.4,pointBackgroundColor:"white",pointBorderColor:"white",pointRadius:4}]},D={responsive:!0,plugins:{legend:{display:!1},title:{display:!1},tooltip:{backgroundColor:"rgba(0,0,0,0.7)",titleColor:"white",bodyColor:"white",displayColors:!1}},scales:{y:{display:!1,grid:{display:!1}},x:{grid:{display:!1,drawBorder:!1},ticks:{color:"rgba(255,255,255,0.7)"}}}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-4 md:p-8 flex items-center justify-center font-sans",children:e.jsxs("div",{className:"w-full max-w-4xl bg-white/10 backdrop-blur-xl rounded-[3rem] shadow-2xl overflow-hidden border border-white/20 flex flex-col md:flex-row relative min-h-[600px]",children:[e.jsx($,{to:"/",className:"absolute top-6 left-6 z-20 text-white/70 hover:text-white transition-colors bg-black/10 p-2 rounded-full backdrop-blur-sm",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"w-full md:w-1/2 p-8 md:p-12 flex flex-col justify-between text-white relative z-10",children:[e.jsxs("div",{children:[e.jsxs("form",{onSubmit:_,className:"relative group",children:[e.jsx("input",{type:"text",value:o,onChange:t=>y(t.target.value),placeholder:"搜索城市...",className:"w-full pl-12 pr-4 py-4 rounded-2xl bg-white/10 border border-white/10 focus:bg-white/20 focus:border-white/30 outline-none transition-all placeholder-white/50 text-white"}),e.jsx(ee,{className:"absolute left-4 top-4 text-white/70 w-6 h-6 group-focus-within:text-white transition-colors"})]}),h&&e.jsx("p",{className:"text-red-300 text-sm mt-2 ml-2",children:h})]}),d?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(A,{className:"w-12 h-12 animate-spin text-white/50"})}):s&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-10 md:mt-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/80 mb-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-lg font-medium",children:[s.name,", ",s.country]})]}),e.jsxs("h1",{className:"text-8xl md:text-9xl font-bold tracking-tighter mb-4",children:[s.temp,"°"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white/20 p-3 rounded-2xl backdrop-blur-md",children:S(s.condition)}),e.jsx("span",{className:"text-3xl font-medium",children:s.condition})]})]})]}),e.jsx("div",{className:"w-full md:w-1/2 bg-black/20 p-8 md:p-12 flex flex-col justify-center text-white backdrop-blur-sm",children:!d&&s&&e.jsxs(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-12",children:[e.jsxs("div",{className:"bg-white/5 p-6 rounded-3xl border border-white/10 hover:bg-white/10 transition-colors",children:[e.jsx("p",{className:"text-white/60 mb-2",children:"湿度"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"w-8 h-8 text-blue-300"}),e.jsxs("span",{className:"text-2xl font-bold",children:[s.humidity,"%"]})]})]}),e.jsxs("div",{className:"bg-white/5 p-6 rounded-3xl border border-white/10 hover:bg-white/10 transition-colors",children:[e.jsx("p",{className:"text-white/60 mb-2",children:"风速"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-teal-300"}),e.jsxs("span",{className:"text-2xl font-bold",children:[s.wind," ",e.jsx("span",{className:"text-sm font-normal text-white/60",children:"km/h"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium mb-6 flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5 text-white/60"})," 24小时预报"]}),e.jsx("div",{className:"h-48 w-full",children:a&&e.jsx(O,{data:L,options:D})})]})]})})]})})};export{ie as default};
