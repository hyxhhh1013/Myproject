import{r as h,d as n,j as e}from"./index-DA1mDptU.js";import{F as s,I as t}from"./index-BktCRfXg.js";import{s as l}from"./index-CcWkhPZ4.js";import{B as u}from"./index-BXfGwkoA.js";import{C as g,T as b}from"./index-D8bVfsCA.js";import"./index-DcAOwtUU.js";const{TextArea:p}=t,v=()=>{const[c]=s.useForm(),[d]=s.useForm(),[m,i]=h.useState(!1);h.useEffect(()=>{j()},[]);const j=async()=>{try{const r=await n.get("/site-config");c.setFieldsValue(r.data)}catch(r){console.error("Failed to fetch config:",r),l.error("获取配置失败")}},f=async r=>{i(!0);try{await n.put("/site-config",r),l.success("保存成功")}catch(a){console.error("Failed to save config:",a),l.error("保存失败")}finally{i(!1)}},y=async r=>{var a,o;i(!0);try{await n.put("/auth/change-password",r),l.success("密码修改成功，请重新登录"),d.resetFields()}catch(x){console.error("Failed to change password:",x),l.error(((o=(a=x.response)==null?void 0:a.data)==null?void 0:o.error)||"密码修改失败")}finally{i(!1)}},w=[{key:"1",label:"基本设置",children:e.jsxs(s,{form:c,layout:"vertical",onFinish:f,initialValues:{siteTitle:"My Portfolio",aboutMe:"",seoKeywords:"",seoDescription:"",icpCode:""},children:[e.jsx(s.Item,{label:"站点标题",name:"siteTitle",rules:[{required:!0,message:"请输入站点标题"}],children:e.jsx(t,{placeholder:"例如：我的个人作品集"})}),e.jsx(s.Item,{label:"关于我 (About Me)",name:"aboutMe",help:"这将显示在关于我页面",children:e.jsx(p,{rows:6,placeholder:"介绍一下你自己..."})}),e.jsx(s.Item,{label:"SEO 关键词",name:"seoKeywords",help:"用逗号分隔，例如：摄影, 前端, 设计",children:e.jsx(t,{placeholder:"SEO Keywords"})}),e.jsx(s.Item,{label:"SEO 描述",name:"seoDescription",children:e.jsx(p,{rows:3,placeholder:"SEO Description"})}),e.jsx(s.Item,{label:"ICP 备案号",name:"icpCode",children:e.jsx(t,{placeholder:"例如：京ICP备xxxxxxxx号"})}),e.jsx(s.Item,{children:e.jsx(u,{type:"primary",htmlType:"submit",loading:m,children:"保存设置"})})]})},{key:"2",label:"安全设置",children:e.jsxs(s,{form:d,layout:"vertical",onFinish:y,children:[e.jsx(s.Item,{label:"当前密码",name:"currentPassword",rules:[{required:!0,message:"请输入当前密码"}],children:e.jsx(t.Password,{})}),e.jsx(s.Item,{label:"新密码",name:"newPassword",rules:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度至少6位"}],children:e.jsx(t.Password,{})}),e.jsx(s.Item,{label:"确认新密码",name:"confirmPassword",dependencies:["newPassword"],rules:[{required:!0,message:"请确认新密码"},({getFieldValue:r})=>({validator(a,o){return!o||r("newPassword")===o?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致"))}})],children:e.jsx(t.Password,{})}),e.jsx(s.Item,{children:e.jsx(u,{type:"primary",htmlType:"submit",loading:m,danger:!0,children:"修改密码"})})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"系统设置"}),e.jsx(g,{children:e.jsx(b,{defaultActiveKey:"1",items:w})})]})};export{v as default};
