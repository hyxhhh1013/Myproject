import{r,m as B,a as A,d as q,j as n}from"./index-DA1mDptU.js";import{D as Xe,g as _e,S as Ue,v as Ke,f as Je,C as Qe}from"./sortable.esm-Bv64-wOJ.js";import{C as se,R as $e,F as b,I as ie}from"./index-BktCRfXg.js";import{I as Ye,C as ve,c as Ze,t as et,g as He,m as Be,u as $,r as De,a as Oe,_ as Me,K as ze,b as tt,F as nt,D as it,d as at,R as st,s as j}from"./index-CcWkhPZ4.js";import{u as We,a as rt,r as Pe,b as Ve,W as lt,S as ae,B as G,R as ot,T as ct}from"./index-BXfGwkoA.js";import{R as Ne}from"./UploadOutlined-B9Wss_5y.js";import{C as dt}from"./index-D8bVfsCA.js";import{m as mt,P as gt,D as ht,S as ut,a as ee,F as pt,M as xe,T as Fe}from"./index-MtB7_Q9R.js";import{U as Ie}from"./index-CHqQizDv.js";import{R as Le,P as Re,I as Te}from"./index-HdzSYL8i.js";import{R as ke}from"./DeleteOutlined-DBmt2RbQ.js";import"./index-DcAOwtUU.js";var xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]},name:"menu",theme:"outlined"};function je(){return je=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t},je.apply(this,arguments)}const $t=(t,e)=>r.createElement(Ye,je({},t,{ref:e,icon:xt})),ft=r.forwardRef($t),we=B.createContext({});we.Consumer;const St=({prefixCls:t,className:e,avatar:a,title:o,description:g,...m})=>{const{getPrefixCls:h}=r.useContext(ve),l=h("list",t),s=A(`${l}-item-meta`,e),c=B.createElement("div",{className:`${l}-item-meta-content`},o&&B.createElement("h4",{className:`${l}-item-meta-title`},o),g&&B.createElement("div",{className:`${l}-item-meta-description`},g));return B.createElement("div",{...m,className:s},a&&B.createElement("div",{className:`${l}-item-meta-avatar`},a),(o||g)&&c)},yt=B.forwardRef((t,e)=>{const{prefixCls:a,children:o,actions:g,extra:m,styles:h,className:l,classNames:s,colStyle:c,...f}=t,{grid:p,itemLayout:x}=r.useContext(we),{getPrefixCls:P,list:v}=r.useContext(ve),w=S=>{var N,H;return A((H=(N=v==null?void 0:v.item)==null?void 0:N.classNames)==null?void 0:H[S],s==null?void 0:s[S])},k=S=>{var N,H;return{...(H=(N=v==null?void 0:v.item)==null?void 0:N.styles)==null?void 0:H[S],...h==null?void 0:h[S]}},R=()=>{const S=et(o);return S.some(H=>typeof H=="string")&&S.length>1},F=()=>x==="vertical"?!!m:!R(),y=P("list",a),L=g&&g.length>0&&B.createElement("ul",{className:A(`${y}-item-action`,w("actions")),key:"actions",style:k("actions")},g.map((S,N)=>B.createElement("li",{key:`${y}-item-action-${N}`},S,N!==g.length-1&&B.createElement("em",{className:`${y}-item-action-split`})))),I=p?"div":"li",C=B.createElement(I,{...f,...p?{}:{ref:e},className:A(`${y}-item`,{[`${y}-item-no-flex`]:!F()},l)},x==="vertical"&&m?[B.createElement("div",{className:`${y}-item-main`,key:"content"},o,L),B.createElement("div",{className:A(`${y}-item-extra`,w("extra")),key:"extra",style:k("extra")},m)]:[o,L,Ze(m,{key:"extra"})]);return p?B.createElement(se,{ref:e,flex:1,style:c},C):C}),qe=yt;qe.Meta=St;const bt=t=>{const{listBorderedCls:e,componentCls:a,paddingLG:o,margin:g,itemPaddingSM:m,itemPaddingLG:h,marginLG:l,borderRadiusLG:s}=t,c=$(t.calc(s).sub(t.lineWidth).equal());return{[e]:{border:`${$(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:s,[`${a}-header`]:{borderRadius:`${c} ${c} 0 0`},[`${a}-footer`]:{borderRadius:`0 0 ${c} ${c}`},[`${a}-header,${a}-footer,${a}-item`]:{paddingInline:o},[`${a}-pagination`]:{margin:`${$(g)} ${$(l)}`}},[`${e}${a}-sm`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:m}},[`${e}${a}-lg`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:h}}}},It=t=>{const{componentCls:e,screenSM:a,screenMD:o,marginLG:g,marginSM:m,margin:h}=t;return{[`@media screen and (max-width:${o}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:g}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:g}}}},[`@media screen and (max-width: ${a}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:m}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${$(h)}`}}}}}},jt=t=>{const{componentCls:e,antCls:a,controlHeight:o,minHeight:g,paddingSM:m,marginLG:h,padding:l,itemPadding:s,colorPrimary:c,itemPaddingSM:f,itemPaddingLG:p,paddingXS:x,margin:P,colorText:v,colorTextDescription:w,motionDurationSlow:k,lineWidth:R,headerBg:F,footerBg:y,emptyTextPadding:L,metaMarginBottom:I,avatarMarginRight:C,titleMarginBottom:S,descriptionFontSize:N}=t;return{[e]:{...De(t),position:"relative","--rc-virtual-list-scrollbar-bg":t.colorSplit,"*":{outline:"none"},[`${e}-header`]:{background:F},[`${e}-footer`]:{background:y},[`${e}-header, ${e}-footer`]:{paddingBlock:m},[`${e}-pagination`]:{marginBlockStart:h,[`${a}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:g,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:s,color:v,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:C},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:v},[`${e}-item-meta-title`]:{margin:`0 0 ${$(t.marginXXS)} 0`,color:v,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:v,transition:`all ${k}`,"&:hover":{color:c}}},[`${e}-item-meta-description`]:{color:w,fontSize:N,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${$(x)}`,color:w,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:R,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${$(l)} 0`,color:w,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:L,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}},[`${e}-grid ${a}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:P,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:h},[`${e}-item-meta`]:{marginBlockEnd:I,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:S,color:v,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:l,marginInlineStart:"auto","> li":{padding:`0 ${$(l)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${$(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${$(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${$(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:o},[`${e}-split${e}-something-after-last-item ${a}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${$(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:p},[`${e}-sm ${e}-item`]:{padding:f},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},Ct=t=>({contentWidth:220,itemPadding:`${$(t.paddingContentVertical)} 0`,itemPaddingSM:`${$(t.paddingContentVerticalSM)} ${$(t.paddingContentHorizontal)}`,itemPaddingLG:`${$(t.paddingContentVerticalLG)} ${$(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),vt=He("List",t=>{const e=Be(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[jt(e),bt(e),It(e)]},Ct),wt=(t,e)=>{const{pagination:a=!1,prefixCls:o,bordered:g=!1,split:m=!0,className:h,rootClassName:l,style:s,children:c,itemLayout:f,loadMore:p,grid:x,dataSource:P=[],size:v,header:w,footer:k,loading:R=!1,rowKey:F,renderItem:y,locale:L,...I}=t,C=a&&typeof a=="object"?a:{},[S,N]=r.useState(C.defaultCurrent||1),[H,Q]=r.useState(C.defaultPageSize||10),{getPrefixCls:O,direction:Y,className:Z,style:W}=Oe("list"),{renderEmpty:X}=r.useContext(ve),T={current:1,total:0,position:"bottom"},te=z=>(D,J)=>{var Ee;N(D),Q(J),a&&((Ee=a==null?void 0:a[z])==null||Ee.call(a,D,J))},le=te("onChange"),de=te("onShowSizeChange"),me=(z,D)=>{if(!y)return null;let J;return typeof F=="function"?J=F(z):F?J=z[F]:J=z.key,J||(J=`list-item-${D}`),r.createElement(r.Fragment,{key:J},y(z,D))},ge=!!(p||a||k),E=O("list",o),[Se,ue]=vt(E);let _=R;typeof _=="boolean"&&(_={spinning:_});const he=!!(_!=null&&_.spinning),ye=We(v);let ne="";switch(ye){case"large":ne="lg";break;case"small":ne="sm";break}const be=A(E,{[`${E}-vertical`]:f==="vertical",[`${E}-${ne}`]:ne,[`${E}-split`]:m,[`${E}-bordered`]:g,[`${E}-loading`]:he,[`${E}-grid`]:!!x,[`${E}-something-after-last-item`]:ge,[`${E}-rtl`]:Y==="rtl"},Z,h,l,Se,ue),i=mt(T,{total:P.length,current:S,pageSize:H},a||{}),d=Math.ceil(i.total/i.pageSize);i.current=Math.min(i.current,d);const u=a&&r.createElement("div",{className:A(`${E}-pagination`)},r.createElement(gt,{align:"end",...i,onChange:le,onShowSizeChange:de}));let M=Me(P);a&&P.length>(i.current-1)*i.pageSize&&(M=Me(P).splice((i.current-1)*i.pageSize,i.pageSize));const U=Object.keys(x||{}).some(z=>["xs","sm","md","lg","xl","xxl"].includes(z)),K=rt(U),oe=r.useMemo(()=>{for(let z=0;z<Pe.length;z+=1){const D=Pe[z];if(K[D])return D}},[K]),pe=r.useMemo(()=>{if(!x)return;const z=oe&&x[oe]?x[oe]:x.column;if(z)return{width:`${100/z}%`,maxWidth:`${100/z}%`}},[JSON.stringify(x),oe]);let V=he&&r.createElement("div",{style:{minHeight:53}});if(M.length>0){const z=M.map(me);V=x?r.createElement($e,{gutter:x.gutter},r.Children.map(z,D=>r.createElement("div",{key:D==null?void 0:D.key,style:pe},D))):r.createElement("ul",{className:`${E}-items`},z)}else!c&&!he&&(V=r.createElement("div",{className:`${E}-empty-text`},(L==null?void 0:L.emptyText)||(X==null?void 0:X("List"))||r.createElement(ht,{componentName:"List"})));const ce=i.position,Ae=r.useMemo(()=>({grid:x,itemLayout:f}),[JSON.stringify(x),f]);return r.createElement(we.Provider,{value:Ae},r.createElement("div",{ref:e,style:{...W,...s},className:be,...I},(ce==="top"||ce==="both")&&u,w&&r.createElement("div",{className:`${E}-header`},w),r.createElement(ut,{..._},V,c),k&&r.createElement("div",{className:`${E}-footer`},k),p||(ce==="bottom"||ce==="both")&&u))},Et=r.forwardRef(wt),fe=Et;fe.Item=qe;function Ce(){return Ce=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t},Ce.apply(this,arguments)}const Ge=r.forwardRef(({prefixCls:t="rc-switch",className:e,checked:a,defaultChecked:o,disabled:g,loadingIcon:m,checkedChildren:h,unCheckedChildren:l,onClick:s,onChange:c,onKeyDown:f,styles:p,classNames:x,...P},v)=>{const[w,k]=Ve(o??!1,a);function R(I,C){let S=w;return g||(S=I,k(S),c==null||c(S,C)),S}function F(I){I.which===ze.LEFT?R(!1,I):I.which===ze.RIGHT&&R(!0,I),f==null||f(I)}function y(I){const C=R(!w,I);s==null||s(C,I)}const L=A(t,e,{[`${t}-checked`]:w,[`${t}-disabled`]:g});return r.createElement("button",Ce({},P,{type:"button",role:"switch","aria-checked":w,disabled:g,className:L,ref:v,onKeyDown:F,onClick:y}),m,r.createElement("span",{className:`${t}-inner`},r.createElement("span",{className:A(`${t}-inner-checked`,x==null?void 0:x.content),style:p==null?void 0:p.content},h),r.createElement("span",{className:A(`${t}-inner-unchecked`,x==null?void 0:x.content),style:p==null?void 0:p.content},l)))});Ge.displayName="Switch";const Mt=t=>{const{componentCls:e,trackHeightSM:a,trackPadding:o,trackMinWidthSM:g,innerMinMarginSM:m,innerMaxMarginSM:h,handleSizeSM:l,calc:s}=t,c=`${e}-inner`,f=$(s(l).add(s(o).mul(2)).equal()),p=$(s(h).mul(2).equal());return{[e]:{[`&${e}-small`]:{minWidth:g,height:a,lineHeight:$(a),[`${e}-inner`]:{paddingInlineStart:h,paddingInlineEnd:m,[`${c}-checked, ${c}-unchecked`]:{minHeight:a},[`${c}-checked`]:{marginInlineStart:`calc(-100% + ${f} - ${p})`,marginInlineEnd:`calc(100% - ${f} + ${p})`},[`${c}-unchecked`]:{marginTop:s(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${e}-handle`]:{width:l,height:l},[`${e}-loading-icon`]:{top:s(s(l).sub(t.switchLoadingIconSize)).div(2).equal(),fontSize:t.switchLoadingIconSize},[`&${e}-checked`]:{[`${e}-inner`]:{paddingInlineStart:m,paddingInlineEnd:h,[`${c}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${c}-unchecked`]:{marginInlineStart:`calc(100% - ${f} + ${p})`,marginInlineEnd:`calc(-100% + ${f} - ${p})`}},[`${e}-handle`]:{insetInlineStart:`calc(100% - ${$(s(l).add(o).equal())})`}},[`&:not(${e}-disabled):active`]:{[`&:not(${e}-checked) ${c}`]:{[`${c}-unchecked`]:{marginInlineStart:s(t.marginXXS).div(2).equal(),marginInlineEnd:s(t.marginXXS).mul(-1).div(2).equal()}},[`&${e}-checked ${c}`]:{[`${c}-checked`]:{marginInlineStart:s(t.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:s(t.marginXXS).div(2).equal()}}}}}}},zt=t=>{const{componentCls:e,handleSize:a,calc:o}=t;return{[e]:{[`${e}-loading-icon${t.iconCls}`]:{position:"relative",top:o(o(a).sub(t.fontSize)).div(2).equal(),color:t.switchLoadingIconColor,verticalAlign:"top"},[`&${e}-checked ${e}-loading-icon`]:{color:t.switchColor}}}},Pt=t=>{const{componentCls:e,trackPadding:a,handleBg:o,handleShadow:g,handleSize:m,calc:h}=t,l=`${e}-handle`;return{[e]:{[l]:{position:"absolute",top:a,insetInlineStart:a,width:m,height:m,transition:`all ${t.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:o,borderRadius:h(m).div(2).equal(),boxShadow:g,transition:`all ${t.switchDuration} ease-in-out`,content:'""'}},[`&${e}-checked ${l}`]:{insetInlineStart:`calc(100% - ${$(h(m).add(a).equal())})`},[`&:not(${e}-disabled):active`]:{[`${l}::before`]:{insetInlineEnd:t.switchHandleActiveInset,insetInlineStart:0},[`&${e}-checked ${l}::before`]:{insetInlineEnd:0,insetInlineStart:t.switchHandleActiveInset}}}}},Nt=t=>{const{componentCls:e,trackHeight:a,trackPadding:o,innerMinMargin:g,innerMaxMargin:m,handleSize:h,calc:l}=t,s=`${e}-inner`,c=$(l(h).add(l(o).mul(2)).equal()),f=$(l(m).mul(2).equal());return{[e]:{[s]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:m,paddingInlineEnd:g,transition:`padding-inline-start ${t.switchDuration} ease-in-out, padding-inline-end ${t.switchDuration} ease-in-out`,[`${s}-checked, ${s}-unchecked`]:{display:"block",color:t.colorTextLightSolid,fontSize:t.fontSizeSM,transition:`margin-inline-start ${t.switchDuration} ease-in-out, margin-inline-end ${t.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:a},[`${s}-checked`]:{marginInlineStart:`calc(-100% + ${c} - ${f})`,marginInlineEnd:`calc(100% - ${c} + ${f})`},[`${s}-unchecked`]:{marginTop:l(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${e}-checked ${s}`]:{paddingInlineStart:g,paddingInlineEnd:m,[`${s}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${s}-unchecked`]:{marginInlineStart:`calc(100% - ${c} + ${f})`,marginInlineEnd:`calc(-100% + ${c} - ${f})`}},[`&:not(${e}-disabled):active`]:{[`&:not(${e}-checked) ${s}`]:{[`${s}-unchecked`]:{marginInlineStart:l(o).mul(2).equal(),marginInlineEnd:l(o).mul(-1).mul(2).equal()}},[`&${e}-checked ${s}`]:{[`${s}-checked`]:{marginInlineStart:l(o).mul(-1).mul(2).equal(),marginInlineEnd:l(o).mul(2).equal()}}}}}},Ft=t=>{const{componentCls:e,trackHeight:a,trackMinWidth:o}=t;return{[e]:{...De(t),position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:o,height:a,lineHeight:$(a),verticalAlign:"middle",background:t.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${t.motionDurationMid}`,userSelect:"none",[`&:hover:not(${e}-disabled)`]:{background:t.colorTextTertiary},...tt(t),[`&${e}-checked`]:{background:t.switchColor,[`&:hover:not(${e}-disabled)`]:{background:t.colorPrimaryHover}},[`&${e}-loading, &${e}-disabled`]:{cursor:"not-allowed",opacity:t.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${e}-rtl`]:{direction:"rtl"}}}},Lt=t=>{const{fontSize:e,lineHeight:a,controlHeight:o,colorWhite:g}=t,m=e*a,h=o/2,l=2,s=m-l*2,c=h-l*2;return{trackHeight:m,trackHeightSM:h,trackMinWidth:s*2+l*4,trackMinWidthSM:c*2+l*2,trackPadding:l,handleBg:g,handleSize:s,handleSizeSM:c,handleShadow:`0 2px 4px 0 ${new nt("#00230b").setA(.2).toRgbString()}`,innerMinMargin:s/2,innerMaxMargin:s+l+l*2,innerMinMarginSM:c/2,innerMaxMarginSM:c+l+l*2}},Rt=He("Switch",t=>{const e=Be(t,{switchDuration:t.motionDurationMid,switchColor:t.colorPrimary,switchDisabledOpacity:t.opacityLoading,switchLoadingIconSize:t.calc(t.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${t.opacityLoading})`,switchHandleActiveInset:"-30%"});return[Ft(e),Nt(e),Pt(e),zt(e),Mt(e)]},Lt),Tt=r.forwardRef((t,e)=>{const{prefixCls:a,size:o,disabled:g,loading:m,className:h,rootClassName:l,style:s,checked:c,value:f,defaultChecked:p,defaultValue:x,onChange:P,styles:v,classNames:w,...k}=t,[R,F]=Ve(p??x??!1,c??f),{getPrefixCls:y,direction:L,className:I,style:C,classNames:S,styles:N}=Oe("switch"),H=r.useContext(it),Q=(g??H)||m,O=y("switch",a),Y=r.createElement("div",{className:`${O}-handle`},m&&r.createElement(st,{className:`${O}-loading-icon`})),[Z,W]=Rt(O),X=We(o),T={...t,size:X,disabled:Q},[te,le]=at([S,w],[N,v],{props:T}),de=A(I,{[`${O}-small`]:X==="small",[`${O}-loading`]:m,[`${O}-rtl`]:L==="rtl"},h,l,te.root,Z,W),me={...le.root,...C,...s},ge=(...E)=>{F(E[0]),P==null||P(...E)};return r.createElement(lt,{component:"Switch",disabled:Q},r.createElement(Ge,{...k,classNames:te,styles:le,checked:R,onChange:ge,prefixCls:O,className:de,style:me,disabled:Q,ref:e,loadingIcon:Y}))}),re=Tt;re.__ANT_SWITCH=!0;const kt=({children:t,...e})=>{const{attributes:a,listeners:o,setNodeRef:g,transform:m,transition:h,isDragging:l}=Je({id:e["data-row-key"]}),s={...e.style,transform:Qe.Transform.toString(m&&{...m,scaleY:1}),transition:h,cursor:"move",...l?{position:"relative",zIndex:9999}:{}};return n.jsx("tr",{...e,ref:g,style:s,...a,...o,children:t})},Kt=()=>{const[t,e]=r.useState([]),[a,o]=r.useState([]),[g,m]=r.useState(!0),[h,l]=r.useState(null),[s,c]=r.useState(""),[f,p]=r.useState(!1),[x,P]=r.useState(!1),[v,w]=r.useState(!1),[k,R]=r.useState(!1),[F]=b.useForm(),[y]=b.useForm(),[L]=b.useForm(),[I]=b.useForm(),[C,S]=r.useState([]),[N,H]=r.useState(!1),[Q,O]=r.useState(null),[Y,Z]=r.useState(null),[W,X]=r.useState([]),T=r.useCallback(async()=>{try{m(!0);const[i,d]=await Promise.all([q.get("/photo-categories"),q.get("/photos?limit=100")]);o(i.data),e(d.data.photos)}catch(i){console.error("Failed to fetch data:",i),j.error("加载数据失败")}finally{m(!1)}},[]);r.useEffect(()=>{T()},[T]);const te=async()=>{var i,d;try{const u=await F.validateFields();if(C.length===0){j.warning("请至少选择一张图片");return}H(!0);const M=new FormData;C.forEach(K=>{K.originFileObj&&M.append("images",K.originFileObj)}),M.append("categoryId",u.categoryId),M.append("isFeatured",u.isFeatured?"true":"false"),M.append("isVisible",u.isVisible?"true":"false"),M.append("title",u.title||""),M.append("description",u.description||"");const U=await q.post("/photos/bulk",M,{headers:{"Content-Type":"multipart/form-data"}});j.success(`成功上传 ${U.data.photos.length} 张照片`),p(!1),F.resetFields(),S([]),T()}catch(u){console.error("Upload failed:",u),j.error(((d=(i=u.response)==null?void 0:i.data)==null?void 0:d.message)||"上传失败")}finally{H(!1)}},le={onRemove:i=>{const d=C.indexOf(i),u=C.slice();u.splice(d,1),S(u)},beforeUpload:i=>i.type.startsWith("image/")?i.size/1024/1024<10?(S([...C,i]),!1):(j.error("图片大小不能超过 10MB"),Ie.LIST_IGNORE):(j.error(`${i.name} 不是图片文件`),Ie.LIST_IGNORE),fileList:C,multiple:!0,listType:"picture"},de=async()=>{try{const i=await y.validateFields();Y?(await q.put(`/photo-categories/${Y.id}`,i),j.success("分类更新成功")):(await q.post("/photo-categories",i),j.success("分类创建成功")),Z(null),y.resetFields(),T()}catch(i){console.error("Save category failed:",i),j.error("保存分类失败")}},me=async i=>{try{await q.delete(`/photo-categories/${i}`),j.success("分类删除成功"),T()}catch{j.error("删除分类失败，可能该分类下还有照片")}},ge=async i=>{try{await q.delete(`/photos/${i}`),j.success("删除成功"),T()}catch{j.error("删除失败")}},E=async()=>{if(W.length!==0)try{await q.post("/api/photos/batch/delete",{ids:W}),j.success(`成功删除 ${W.length} 个作品`),X([]),T()}catch{j.error("批量删除失败")}},Se=async()=>{try{const i=await I.validateFields();await q.post("/photos/batch/category",{ids:W,categoryId:i.categoryId}),j.success(`成功更新 ${W.length} 个作品的分类`),R(!1),I.resetFields(),X([]),T()}catch{j.error("批量分类失败")}},ue=async(i,d,u)=>{try{await q.put(`/photos/${i}`,{[d]:u}),j.success("状态更新成功"),e(M=>M.map(U=>U.id===i?{...U,[d]:u}:U))}catch{j.error("状态更新失败"),T()}},_=i=>{O(i),L.setFieldsValue({title:i.title,description:i.description,categoryId:i.category.id,isFeatured:i.isFeatured,isVisible:i.isVisible}),w(!0)},he=async()=>{if(Q)try{const i=await L.validateFields();await q.put(`/photos/${Q.id}`,i),j.success("更新成功"),w(!1),O(null),T()}catch{j.error("更新失败")}},ye=async({active:i,over:d})=>{i.id!==(d==null?void 0:d.id)&&e(u=>{const M=u.findIndex(V=>V.id===i.id),U=u.findIndex(V=>V.id===(d==null?void 0:d.id)),K=[...u],[oe]=K.splice(M,1);K.splice(U,0,oe);const pe=K.map((V,ce)=>({...V,orderIndex:ce}));return q.put("/photos/order/update",{photos:pe.map(V=>({id:V.id,orderIndex:V.orderIndex}))}).catch(()=>{j.error("排序保存失败"),T()}),pe})},ne=t.filter(i=>{var M;const d=h?i.category.id===h:!0,u=s?i.title.toLowerCase().includes(s.toLowerCase())||((M=i.description)==null?void 0:M.toLowerCase().includes(s.toLowerCase())):!0;return d&&u}),be=[{title:"排序",key:"sort",width:50,render:()=>n.jsx(ft,{className:"cursor-grab text-gray-400"})},{title:"缩略图",dataIndex:"thumbnailUrl",key:"thumbnailUrl",width:100,render:(i,d)=>n.jsx(Te.PreviewGroup,{children:n.jsx(Te,{src:d.thumbnailUrl,width:80,height:60,style:{objectFit:"cover",borderRadius:4},preview:{src:d.imageUrl}})})},{title:"标题/描述",dataIndex:"title",key:"title",render:(i,d)=>n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:i}),n.jsx("div",{className:"text-gray-500 text-xs truncate max-w-xs",children:d.description})]})},{title:"分类",dataIndex:["category","name"],key:"category",render:i=>n.jsx(Fe,{color:"blue",children:i})},{title:"状态",key:"status",render:(i,d)=>n.jsxs(ae,{direction:"vertical",size:"small",children:[n.jsxs(ae,{children:[n.jsx("span",{className:"text-xs",children:"置顶:"}),n.jsx(re,{size:"small",checked:d.isFeatured,onChange:u=>ue(d.id,"isFeatured",u)})]}),n.jsxs(ae,{children:[n.jsx("span",{className:"text-xs",children:"可见:"}),n.jsx(re,{size:"small",checked:d.isVisible,onChange:u=>ue(d.id,"isVisible",u)})]})]})},{title:"EXIF",key:"exif",render:(i,d)=>d.exifData?n.jsx(ct,{title:n.jsxs("div",{className:"text-xs",children:[n.jsxs("div",{children:["相机: ",d.exifData.cameraModel]}),n.jsxs("div",{children:["光圈: f/",d.exifData.aperture]}),n.jsxs("div",{children:["焦距: ",d.exifData.focalLength,"mm"]}),n.jsxs("div",{children:["ISO: ",d.exifData.iso]})]}),children:n.jsx(Fe,{children:"EXIF"})}):n.jsx("span",{className:"text-gray-400",children:"-"})},{title:"操作",key:"action",render:(i,d)=>n.jsxs(ae,{size:"small",children:[n.jsx(G,{type:"text",icon:n.jsx(Le,{}),onClick:()=>_(d)}),n.jsx(Re,{title:"确定要删除吗？",onConfirm:()=>ge(d.id),okText:"是",cancelText:"否",children:n.jsx(G,{type:"text",danger:!0,icon:n.jsx(ke,{})})})]})}];return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold",children:"摄影作品管理"}),n.jsx("p",{className:"text-gray-500",children:"管理您的摄影作品，包括上传、分类和排序"})]}),n.jsxs(ae,{children:[n.jsx(G,{onClick:()=>P(!0),children:"分类管理"}),n.jsx(G,{type:"primary",icon:n.jsx(Ne,{}),onClick:()=>p(!0),children:"上传作品"})]})]}),n.jsx(dt,{className:"mb-6",children:n.jsxs($e,{gutter:16,align:"middle",children:[n.jsx(se,{flex:"auto",children:n.jsx(ie,{prefix:n.jsx(ot,{}),placeholder:"搜索作品标题或描述...",value:s,onChange:i=>c(i.target.value),allowClear:!0})}),n.jsx(se,{children:n.jsx(ae,{children:n.jsx(ee,{style:{width:150},placeholder:"全部分类",allowClear:!0,onChange:l,value:h,children:a.map(i=>n.jsxs(ee.Option,{value:i.id,children:[i.name," (",i._count.photos,")"]},i.id))})})})]})}),W.length>0&&n.jsxs("div",{className:"mb-4 bg-blue-50 p-4 rounded flex justify-between items-center",children:[n.jsxs("span",{children:["已选择 ",W.length," 项"]}),n.jsxs(ae,{children:[n.jsx(G,{onClick:()=>R(!0),children:"批量分类"}),n.jsx(G,{danger:!0,onClick:E,children:"批量删除"})]})]}),n.jsx(Xe,{collisionDetection:_e,onDragEnd:ye,children:n.jsx(Ue,{items:ne.map(i=>i.id),strategy:Ke,children:n.jsx(pt,{components:{body:{row:kt}},columns:be,dataSource:ne,rowKey:"id",loading:g,rowSelection:{selectedRowKeys:W,onChange:X},pagination:{defaultPageSize:20,showSizeChanger:!0,showTotal:i=>`共 ${i} 条`}})})}),n.jsx(xe,{title:"上传摄影作品",open:f,onCancel:()=>p(!1),footer:[n.jsx(G,{onClick:()=>p(!1),children:"取消"},"cancel"),n.jsx(G,{type:"primary",loading:N,onClick:te,disabled:C.length===0,children:"开始上传"},"upload")],width:700,children:n.jsxs(b,{form:F,layout:"vertical",initialValues:{isFeatured:!1,isVisible:!0},children:[n.jsx(b.Item,{name:"title",label:"标题",children:n.jsx(ie,{placeholder:"输入作品标题 (选填)"})}),n.jsx(b.Item,{name:"categoryId",label:"分类",rules:[{required:!0,message:"请选择分类"}],children:n.jsx(ee,{placeholder:"选择分类",children:a.map(i=>n.jsx(ee.Option,{value:i.id,children:i.name},i.id))})}),n.jsx(b.Item,{name:"description",label:"描述",children:n.jsx(ie.TextArea,{rows:3,placeholder:"输入作品描述 (选填)"})}),n.jsxs($e,{gutter:16,children:[n.jsx(se,{span:12,children:n.jsx(b.Item,{name:"isFeatured",valuePropName:"checked",label:"置顶",children:n.jsx(re,{})})}),n.jsx(se,{span:12,children:n.jsx(b.Item,{name:"isVisible",valuePropName:"checked",label:"可见",children:n.jsx(re,{})})})]}),n.jsx(b.Item,{label:"选择图片",children:n.jsxs(Ie.Dragger,{...le,children:[n.jsx("p",{className:"ant-upload-drag-icon",children:n.jsx(Ne,{})}),n.jsx("p",{className:"ant-upload-text",children:"点击或拖拽文件到此区域上传"}),n.jsx("p",{className:"ant-upload-hint",children:"支持 JPG, PNG, WebP, GIF 格式"})]})})]})}),n.jsxs(xe,{title:"分类管理",open:x,onCancel:()=>{P(!1),Z(null),y.resetFields()},footer:null,width:600,children:[n.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded",children:[n.jsx("h4",{className:"mb-2 font-medium",children:Y?"编辑分类":"新建分类"}),n.jsxs(b,{form:y,layout:"inline",onFinish:de,children:[n.jsx(b.Item,{name:"name",rules:[{required:!0,message:"请输入名称"}],children:n.jsx(ie,{placeholder:"分类名称"})}),n.jsx(b.Item,{name:"slug",rules:[{required:!0,message:"请输入Slug"}],children:n.jsx(ie,{placeholder:"Slug"})}),n.jsxs(b.Item,{children:[n.jsx(G,{type:"primary",htmlType:"submit",children:"保存"}),Y&&n.jsx(G,{style:{marginLeft:8},onClick:()=>{Z(null),y.resetFields()},children:"取消"})]})]})]}),n.jsx(fe,{itemLayout:"horizontal",dataSource:a,renderItem:i=>n.jsx(fe.Item,{actions:[n.jsx(G,{type:"text",icon:n.jsx(Le,{}),onClick:()=>{Z(i),y.setFieldsValue(i)},children:"编辑"}),n.jsx(Re,{title:"确定删除？",onConfirm:()=>me(i.id),children:n.jsx(G,{type:"text",danger:!0,icon:n.jsx(ke,{}),children:"删除"})})],children:n.jsx(fe.Item.Meta,{title:i.name,description:`Slug: ${i.slug} | ${i._count.photos} 张照片`})})})]}),n.jsx(xe,{title:"批量分类",open:k,onOk:Se,onCancel:()=>R(!1),children:n.jsx(b,{form:I,layout:"vertical",children:n.jsx(b.Item,{name:"categoryId",label:"选择新分类",rules:[{required:!0,message:"请选择分类"}],children:n.jsx(ee,{placeholder:"选择分类",children:a.map(i=>n.jsx(ee.Option,{value:i.id,children:i.name},i.id))})})})}),n.jsx(xe,{title:"编辑作品",open:v,onOk:he,onCancel:()=>w(!1),children:n.jsxs(b,{form:L,layout:"vertical",children:[n.jsx(b.Item,{name:"title",label:"标题",children:n.jsx(ie,{})}),n.jsx(b.Item,{name:"description",label:"描述",children:n.jsx(ie.TextArea,{rows:4})}),n.jsx(b.Item,{name:"categoryId",label:"分类",children:n.jsx(ee,{children:a.map(i=>n.jsx(ee.Option,{value:i.id,children:i.name},i.id))})}),n.jsxs($e,{gutter:16,children:[n.jsx(se,{span:12,children:n.jsx(b.Item,{name:"isFeatured",valuePropName:"checked",label:"置顶",children:n.jsx(re,{})})}),n.jsx(se,{span:12,children:n.jsx(b.Item,{name:"isVisible",valuePropName:"checked",label:"可见",children:n.jsx(re,{})})})]})]})})]})};export{Kt as default};
