import{r as l,j as e,d as u}from"./index-BhbzFmRm.js";import{F as i,C as b,B as j,g as L,I as x,S as z,d as C}from"./index-kBbHJYa7.js";import{F,M as N,S as p,P as R}from"./Table-B3Aa-BfP.js";import{I,s as c}from"./index-CEnH4XFE.js";import{T as $}from"./index-ealqDkwN.js";import{R as P}from"./EditOutlined-Bwl5_b2f.js";import"./index-DcAOwtUU.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};function g(){return g=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])}return s},g.apply(this,arguments)}const k=(s,a)=>l.createElement(I,g({},s,{ref:a,icon:V})),E=l.forwardRef(k);var B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M625.9 115c-5.9 0-11.9 1.6-17.4 5.3L254 352H90c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h164l354.5 231.7c5.5 3.6 11.6 5.3 17.4 5.3 16.7 0 32.1-13.3 32.1-32.1V147.1c0-18.8-15.4-32.1-32.1-32.1zM586 803L293.4 611.7l-18-11.7H146V424h129.4l17.9-11.7L586 221v582zm348-327H806c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16h128c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16zm-41.9 261.8l-110.3-63.7a15.9 15.9 0 00-21.7 5.9l-19.9 34.5c-4.4 7.6-1.8 17.4 5.8 21.8L856.3 800a15.9 15.9 0 0021.7-5.9l19.9-34.5c4.4-7.6 1.7-17.4-5.8-21.8zM760 344a15.9 15.9 0 0021.7 5.9L892 286.2c7.6-4.4 10.2-14.2 5.8-21.8L878 230a15.9 15.9 0 00-21.7-5.9L746 287.8a15.99 15.99 0 00-5.8 21.8L760 344z"}}]},name:"sound",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])}return s},v.apply(this,arguments)}const _=(s,a)=>l.createElement(I,v({},s,{ref:a,icon:B})),D=l.forwardRef(_),J=()=>{const[s,a]=l.useState([]),[n,r]=l.useState(!0),[w,d]=l.useState(!1),[f,y]=l.useState(null),[o]=i.useForm(),h=async()=>{try{r(!0);const t=await u.get("/api/music");a(t.data)}catch{c.error("加载音乐失败")}finally{r(!1)}};l.useEffect(()=>{h()},[]);const S=async()=>{try{const t=await o.validateFields();f?(await u.put(`/api/music/${f.id}`,t),c.success("更新成功")):(await u.post("/api/music",t),c.success("创建成功")),d(!1),o.resetFields(),h()}catch{c.error("操作失败")}},O=async t=>{try{await u.delete(`/api/music/${t}`),c.success("删除成功"),h()}catch{c.error("删除失败")}},M=[{title:"封面",dataIndex:"coverUrl",key:"coverUrl",render:t=>t?e.jsx("img",{src:t,alt:"cover",className:"w-10 h-10 rounded object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded"})},{title:"标题",dataIndex:"title",key:"title",render:t=>e.jsx("span",{className:"font-medium",children:t})},{title:"艺术家",dataIndex:"artist",key:"artist"},{title:"平台",dataIndex:"platform",key:"platform",render:t=>e.jsx($,{children:t})},{title:"链接",dataIndex:"url",key:"url",ellipsis:!0,render:t=>e.jsx("a",{href:t,target:"_blank",rel:"noreferrer",className:"text-blue-500",children:t})},{title:"操作",key:"action",render:(t,m)=>e.jsxs(z,{children:[e.jsx(j,{type:"text",icon:e.jsx(P,{}),onClick:()=>{y(m),o.setFieldsValue(m),d(!0)}}),e.jsx(R,{title:"确定删除?",onConfirm:()=>O(m.id),children:e.jsx(j,{type:"text",danger:!0,icon:e.jsx(C,{})})})]})}];return e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx(b,{className:"mb-6",bodyStyle:{padding:"12px 16px"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"音乐管理"}),e.jsx(j,{type:"primary",icon:e.jsx(L,{}),onClick:()=>{y(null),o.resetFields(),d(!0)},children:"添加音乐"})]})}),e.jsx(b,{bodyStyle:{padding:0},className:"overflow-hidden",children:e.jsx(F,{columns:M,dataSource:s,rowKey:"id",loading:n,scroll:{x:600},pagination:{defaultPageSize:10}})}),e.jsx(N,{title:f?"编辑音乐":"添加音乐",open:w,onOk:S,onCancel:()=>d(!1),children:e.jsxs(i,{form:o,layout:"vertical",children:[e.jsx(i.Item,{name:"title",label:"标题",rules:[{required:!0}],children:e.jsx(x,{prefix:e.jsx(D,{})})}),e.jsx(i.Item,{name:"artist",label:"艺术家",children:e.jsx(x,{})}),e.jsx(i.Item,{name:"platform",label:"平台",initialValue:"netease",children:e.jsxs(p,{children:[e.jsx(p.Option,{value:"netease",children:"网易云音乐"}),e.jsx(p.Option,{value:"spotify",children:"Spotify"}),e.jsx(p.Option,{value:"local",children:"本地上传"})]})}),e.jsx(i.Item,{name:"url",label:"链接/ID",children:e.jsx(x,{prefix:e.jsx(E,{}),placeholder:"歌曲链接或ID"})}),e.jsx(i.Item,{name:"coverUrl",label:"封面链接",children:e.jsx(x,{placeholder:"https://..."})})]})})]})};export{J as default};
